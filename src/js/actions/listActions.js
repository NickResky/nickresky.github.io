import fetch from 'isomorphic-fetch'
import $ from 'jquery'
import { showLoading, hideLoading } from 'react-redux-loading-bar'

const headers = {
		'Content-Type': 'application/json; charset=utf-8',
		'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjp7ImlkIjo5NzV9LCJpYXQiOjE0Nzc4OTkwNDl9.gDG_4W9uc3iwlXULJURhj7xt26mMDk-KwdyyLAozkho'
}

export function fetchList(props) {
	return fetchListOffline(props);
}

function fetchListApi() {
	const whenFetchList = fetch('https://zenkit.com/api/v1/lists/HJQBQ1Hw', {
		method: 'GET',
		headers: headers
	});
	const whenFetchListElements = fetch('https://zenkit.com/api/v1/lists/HJQBQ1Hw/elements', {
		method: 'GET',
		headers: headers
	});
	const whenFetchListEntries = fetch('https://zenkit.com/api/v1/lists/HJQBQ1Hw/entries/filter/list', {
		method: 'POST',
		headers: headers
	});

	const whenFetchAllData = Promise.all([whenFetchList, whenFetchListElements, whenFetchListEntries]).then(function(results) {
		const listResponse = results[0];
		const elementsResponse = results[1];
		const listEntriesResponse = results[2];
		return Promise.all(
			[
				listResponse.json(),
				elementsResponse.json(),
				listEntriesResponse.json()
			]
		).then(function(results) {
			const listJson = results[0];
			const elementsJson = results[1];
			const entriesJson = results[2];
			return {
				listInfo: listJson,
				listElements: elementsJson,
				listEntries: entriesJson.listEntries
			}
		});
	})
	return {
		type: "FETCH_LIST",
		payload: whenFetchAllData
	}
}

function fetchListOffline(props) {
	//props.dispatch(showLoading())
	var list = {"id":230,"shortId":"HJQBQ1Hw","uuid":"5bd4b3d7-830d-4bd2-bd85-22b51afa6530","name":"Documentation","itemName":null,"isBuilding":false,"isMigrating":false,"sortOrder":11,"description":"","formulaTSortOrder":null,"listFilePolicy":null,"originProvider":null,"originData":null,"defaultViewModus":3,"created_at":"2016-07-14T10:02:35.000Z","updated_at":"2016-10-21T08:51:02.908Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null,"workspaceId":65,"backgroundId":null,"visibility":1,"iconClassNames":"fa fa-info","itemNamePlural":null,"created_by":3};
	const listElements = [{"id":2299,"shortId":"SJLQSX1Sw","uuid":"d918a1f9-95b8-4361-8400-6b5b8d7e16e1","name":"Title","displayName":null,"businessData":{"text":""},"elementData":{"placeholder":"","multiline":false},"blocked":false,"isPrimary":true,"isAutoCreated":false,"sortOrder":4,"visible":true,"created_at":"2016-07-14T10:02:35.279Z","updated_at":"2016-07-14T10:02:35.298Z","deprecated_at":null,"elementcategory":1,"listId":230,"description":null},{"id":2295,"shortId":"B1G7HQyBv","uuid":"d42628e2-45ac-427d-81bd-be6a6313e613","name":"Created","displayName":null,"businessData":{},"elementData":{},"blocked":false,"isPrimary":false,"isAutoCreated":false,"sortOrder":0,"visible":true,"created_at":"2016-07-14T10:02:35.139Z","updated_at":"2016-07-14T10:02:35.176Z","deprecated_at":null,"elementcategory":8,"listId":230,"description":null},{"id":2296,"shortId":"Sy7Xr71Hw","uuid":"100fbc70-ca62-492d-8974-bbd91f8779f2","name":"Last Updated","displayName":null,"businessData":{},"elementData":{},"blocked":false,"isPrimary":false,"isAutoCreated":false,"sortOrder":1,"visible":true,"created_at":"2016-07-14T10:02:35.139Z","updated_at":"2016-07-14T10:02:35.177Z","deprecated_at":null,"elementcategory":9,"listId":230,"description":null},{"id":2297,"shortId":"SJNQHmySw","uuid":"d54d858c-f8a0-463f-94f4-389d1181257c","name":"Created By","displayName":null,"businessData":{},"elementData":{"listUsers":null},"blocked":false,"isPrimary":false,"isAutoCreated":false,"sortOrder":2,"visible":true,"created_at":"2016-07-14T10:02:35.139Z","updated_at":"2016-07-14T10:02:35.177Z","deprecated_at":null,"elementcategory":11,"listId":230,"description":null},{"id":2298,"shortId":"HyBQH71rP","uuid":"e7c9421b-234c-4182-af67-742d993b2306","name":"Last Updated By","displayName":null,"businessData":{},"elementData":{"listUsers":null},"blocked":false,"isPrimary":false,"isAutoCreated":false,"sortOrder":3,"visible":true,"created_at":"2016-07-14T10:02:35.139Z","updated_at":"2016-07-14T10:02:35.177Z","deprecated_at":null,"elementcategory":12,"listId":230,"description":null},{"id":2300,"shortId":"SkwXBQkBw","uuid":"48d60014-69cc-495e-8327-c531d056b2af","name":"Section","displayName":null,"businessData":{"categories":[],"categories_sort":[]},"elementData":{"predefinedCategories":[{"id":1,"shortId":"ByaB7kSw","uuid":"90b05937-d3bb-4bdc-817e-7031eb3c9a5c","name":"Teams","colorHex":"#009CDF","originProvider":null,"originData":null,"sortOrder":0,"elementId":2300,"listId":null,"created_at":"2016-07-14T10:02:45.181Z","updated_at":"2016-11-10T15:18:42.546Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":2,"shortId":"Hys8H_M0","uuid":"0a358747-0e18-46fd-a90f-90485c0068ad","name":"Items","colorHex":"#E23838","originProvider":null,"originData":null,"sortOrder":1,"elementId":2300,"listId":null,"created_at":"2016-10-05T12:42:58.932Z","updated_at":"2016-11-10T15:18:42.546Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":9,"shortId":"HykCGFf0","uuid":"bb257553-24b3-4dcf-8666-8af3f0b51f3f","name":"__PRIVATE_Inbox","colorHex":"#F78200","originProvider":null,"originData":null,"sortOrder":2,"elementId":2300,"listId":null,"created_at":"2016-10-05T13:40:22.932Z","updated_at":"2016-11-10T15:18:42.546Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":10,"shortId":"ByS1_KfA","uuid":"da4ee0ba-492c-47d3-94b1-5cb0d78e3fd6","name":"Collections","colorHex":"#5EBD3E","originProvider":null,"originData":null,"sortOrder":3,"elementId":2300,"listId":null,"created_at":"2016-10-05T14:02:05.183Z","updated_at":"2016-11-10T15:18:42.546Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":11,"shortId":"S1Kl95zA","uuid":"b37a45b0-8fbf-4bca-85a5-3c1a50ed9a68","name":"Fields","colorHex":"#D34597","originProvider":null,"originData":null,"sortOrder":4,"elementId":2300,"listId":null,"created_at":"2016-10-05T15:19:12.756Z","updated_at":"2016-11-10T15:18:42.546Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":12,"shortId":"ByG-c9G0","uuid":"4f5847e8-b195-4032-91f6-e15a53467027","name":"Views","colorHex":"#FFB900","originProvider":null,"originData":null,"sortOrder":5,"elementId":2300,"listId":null,"created_at":"2016-10-05T15:19:22.204Z","updated_at":"2016-11-10T15:18:42.546Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":13,"shortId":"B1Bf9qMA","uuid":"d78ddf31-55dc-4e11-898f-e7fdd0cb701e","name":"Using references to link collections","colorHex":"#107A7D","originProvider":null,"originData":null,"sortOrder":6,"elementId":2300,"listId":null,"created_at":"2016-10-05T15:19:41.343Z","updated_at":"2016-11-10T15:18:42.546Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":14,"shortId":"HJY7ccG0","uuid":"bd0dab72-532b-4b5e-a51d-067f70e36e85","name":"Advanced field types and workflows","colorHex":"#EE4726","originProvider":null,"originData":null,"sortOrder":7,"elementId":2300,"listId":null,"created_at":"2016-10-05T15:20:01.266Z","updated_at":"2016-11-10T15:18:42.546Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":15,"shortId":"SyCX95M0","uuid":"0461fd4b-0786-4324-a17c-20f8bd4abfe9","name":"Collaboration","colorHex":"#81C886","originProvider":null,"originData":null,"sortOrder":8,"elementId":2300,"listId":null,"created_at":"2016-10-05T15:20:05.575Z","updated_at":"2016-11-10T15:18:42.547Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":16,"shortId":"SJYE55zA","uuid":"dec938eb-5937-45d3-8f07-44cb12315fbc","name":"Connecting Zenkit to other services","colorHex":"#009CDF","originProvider":null,"originData":null,"sortOrder":9,"elementId":2300,"listId":null,"created_at":"2016-10-05T15:20:16.760Z","updated_at":"2016-11-10T15:18:42.547Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":17,"shortId":"S1VLcqGA","uuid":"87fbcd95-aeb9-4fc1-9722-ed54c6ffb2b1","name":"iOS, Android, Mac, and Windows Apps","colorHex":"#E23838","originProvider":null,"originData":null,"sortOrder":10,"elementId":2300,"listId":null,"created_at":"2016-10-05T15:20:44.192Z","updated_at":"2016-11-10T15:18:42.548Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":18,"shortId":"Bk2LqcM0","uuid":"a5b53a7a-9f03-46c0-9d00-2b9cab5ea327","name":"Exporting and printing","colorHex":"#F78200","originProvider":null,"originData":null,"sortOrder":11,"elementId":2300,"listId":null,"created_at":"2016-10-05T15:20:52.223Z","updated_at":"2016-11-10T15:18:42.548Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":19,"shortId":"Sy4D95MA","uuid":"0bf71c9c-1edb-4d5d-9315-4937f054eb75","name":"Importing and adding data","colorHex":"#5EBD3E","originProvider":null,"originData":null,"sortOrder":12,"elementId":2300,"listId":null,"created_at":"2016-10-05T15:21:00.070Z","updated_at":"2016-11-10T15:18:42.548Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":20,"shortId":"r1jPqqfA","uuid":"9c9c3160-095d-4064-9895-4021d617b8ce","name":"Activity history & Backups","colorHex":"#D34597","originProvider":null,"originData":null,"sortOrder":13,"elementId":2300,"listId":null,"created_at":"2016-10-05T15:21:07.414Z","updated_at":"2016-11-10T15:18:42.548Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":21,"shortId":"rkMOcqGA","uuid":"7f6c3a52-9513-481f-8f89-4100db897828","name":"Tips & Tricks","colorHex":"#FFB900","originProvider":null,"originData":null,"sortOrder":14,"elementId":2300,"listId":null,"created_at":"2016-10-05T15:21:14.377Z","updated_at":"2016-11-10T15:18:42.548Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":22,"shortId":"HyPuccz0","uuid":"4a59f0a3-e32e-433d-90ea-6873a49d6df7","name":"Miscellaneous","colorHex":"#107A7D","originProvider":null,"originData":null,"sortOrder":15,"elementId":2300,"listId":null,"created_at":"2016-10-05T15:21:19.246Z","updated_at":"2016-11-10T15:18:42.548Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":27,"shortId":"SyDziZCR","uuid":"6e0052ca-bb67-4d41-a9be-f5fe1f1b6723","name":"Zenkit for Developers","colorHex":"#EE4726","originProvider":null,"originData":null,"sortOrder":16,"elementId":2300,"listId":null,"created_at":"2016-10-14T07:36:46.876Z","updated_at":"2016-11-10T15:18:42.548Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":28,"shortId":"By3DcmAR","uuid":"e05d5d0c-77c0-4c82-b0cb-e5eb835c2842","name":"Zenkit Account Settings","colorHex":"#81C886","originProvider":null,"originData":null,"sortOrder":17,"elementId":2300,"listId":null,"created_at":"2016-10-14T09:50:28.050Z","updated_at":"2016-11-10T15:18:42.548Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":29,"shortId":"Hy6EJGzZx","uuid":"fa3c030f-91b4-486b-9c27-52947c86f813","name":"__PRIVATE_Section_Descriptions","colorHex":"#009CDF","originProvider":null,"originData":null,"sortOrder":18,"elementId":2300,"listId":null,"created_at":"2016-11-10T15:16:05.494Z","updated_at":"2016-11-10T15:18:42.548Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null}],"multiple":false,"allowInlineCreation":true},"blocked":false,"isPrimary":false,"isAutoCreated":false,"sortOrder":5,"visible":true,"created_at":"2016-07-14T10:02:35.279Z","updated_at":"2016-11-10T15:18:42.575Z","deprecated_at":null,"elementcategory":6,"listId":230,"description":null},{"id":4747,"shortId":"SkvkU_MR","uuid":"2cbc8635-bb39-4cf1-bf4f-11ca5e8b85c0","name":"Stage","displayName":null,"businessData":{"categories":[3],"categories_sort":[{"id":3,"shortId":"Sy-wJI_GC","uuid":"6503a58f-6c18-491b-b051-e5755734cd71","name":"airtable original / todo","colorHex":"#009CDF","originProvider":null,"originData":null,"sortOrder":0,"elementId":4747,"listId":null,"created_at":"2016-10-05T12:45:19.380Z","updated_at":"2016-10-18T09:17:17.022Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null}]},"elementData":{"predefinedCategories":[{"id":3,"shortId":"Sy-wJI_GC","uuid":"6503a58f-6c18-491b-b051-e5755734cd71","name":"airtable original / todo","colorHex":"#009CDF","originProvider":null,"originData":null,"sortOrder":0,"elementId":4747,"listId":null,"created_at":"2016-10-05T12:45:19.380Z","updated_at":"2016-10-18T09:17:17.022Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":4,"shortId":"SyMvyUuMA","uuid":"f1ccb072-a3de-48bf-ae3e-aa5e6b01d150","name":"in progress","colorHex":"#E23838","originProvider":null,"originData":null,"sortOrder":1,"elementId":4747,"listId":null,"created_at":"2016-10-05T12:45:19.380Z","updated_at":"2016-10-18T09:17:17.022Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":6,"shortId":"Syct8uz0","uuid":"3616a2f6-1f3a-497b-aae5-8bd4e9d5ac94","name":"needs images (done)","colorHex":"#5EBD3E","originProvider":null,"originData":null,"sortOrder":2,"elementId":4747,"listId":null,"created_at":"2016-10-05T12:48:02.295Z","updated_at":"2016-10-18T09:17:17.022Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":5,"shortId":"BJmwkLdGR","uuid":"f68c3894-e4d7-4d02-8755-7ef9639c2ab9","name":"done","colorHex":"#F78200","originProvider":null,"originData":null,"sortOrder":3,"elementId":4747,"listId":null,"created_at":"2016-10-05T12:45:19.380Z","updated_at":"2016-10-18T09:17:17.022Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":23,"shortId":"rkB3rcXR","uuid":"77dcc8d0-1f79-4d49-92dc-81c2462cbc65","name":"don't need","colorHex":"#D34597","originProvider":null,"originData":null,"sortOrder":4,"elementId":4747,"listId":null,"created_at":"2016-10-06T09:13:17.116Z","updated_at":"2016-10-18T09:17:17.022Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null}],"multiple":false,"allowInlineCreation":true},"blocked":false,"isPrimary":false,"isAutoCreated":false,"sortOrder":6,"visible":true,"created_at":"2016-10-05T12:45:19.352Z","updated_at":"2016-10-18T09:17:17.036Z","deprecated_at":null,"elementcategory":6,"listId":230,"description":null},{"id":4761,"shortId":"SkDSi_zR","uuid":"f8ae0874-563f-4908-813e-f7b2612cfda6","name":"Production stage","displayName":null,"businessData":{"categories":[],"categories_sort":[]},"elementData":{"predefinedCategories":[{"id":7,"shortId":"S1ZUoOMC","uuid":"77d7d06d-ebbb-437f-a4ef-0a13136041e7","name":"Upcoming","colorHex":"#009CDF","originProvider":null,"originData":null,"sortOrder":0,"elementId":4761,"listId":null,"created_at":"2016-10-05T13:08:24.842Z","updated_at":"2016-10-05T13:08:52.114Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null},{"id":8,"shortId":"HJu8oOMR","uuid":"81cd9cb9-4bd1-433f-89f4-df85f120c7c7","name":"Operational","colorHex":"#E23838","originProvider":null,"originData":null,"sortOrder":1,"elementId":4761,"listId":null,"created_at":"2016-10-05T13:08:32.086Z","updated_at":"2016-10-05T13:08:52.114Z","deprecated_at":null,"origin_created_at":null,"origin_updated_at":null,"origin_deprecated_at":null}],"multiple":true,"allowInlineCreation":true},"blocked":false,"isPrimary":false,"isAutoCreated":false,"sortOrder":7,"visible":true,"created_at":"2016-10-05T13:08:14.657Z","updated_at":"2016-10-05T13:08:52.119Z","deprecated_at":null,"elementcategory":6,"listId":230,"description":null},{"id":4748,"shortId":"rJGHIuM0","uuid":"b2444557-36cb-4e1f-8b5c-109e88ce9e0c","name":"Description","displayName":null,"businessData":{"text":""},"elementData":{"placeholder":"","multiline":true},"blocked":false,"isPrimary":false,"isAutoCreated":false,"sortOrder":8,"visible":true,"created_at":"2016-10-05T12:46:49.598Z","updated_at":"2016-10-05T14:19:45.921Z","deprecated_at":null,"elementcategory":1,"listId":230,"description":null},{"id":4749,"shortId":"rkCLU_MC","uuid":"11bbb3ed-fee1-451c-82ab-5c2b92a35cb9","name":"Airtable Original","displayName":null,"businessData":{"text":""},"elementData":{"placeholder":"","multiline":true},"blocked":false,"isPrimary":false,"isAutoCreated":false,"sortOrder":9,"visible":true,"created_at":"2016-10-05T12:47:18.210Z","updated_at":"2016-10-05T14:10:23.611Z","deprecated_at":null,"elementcategory":1,"listId":230,"description":null},{"id":4800,"shortId":"H1iTgcM0","uuid":"ace42fea-dd18-4d3d-a5ff-8e9e048ff81e","name":"Files","displayName":null,"businessData":{"files":[],"filesData":[]},"elementData":{},"blocked":false,"isPrimary":false,"isAutoCreated":false,"sortOrder":10,"visible":true,"created_at":"2016-10-05T14:40:03.089Z","updated_at":"2016-10-05T14:40:03.108Z","deprecated_at":null,"elementcategory":15,"listId":230,"description":null},{"id":5270,"shortId":"S1S2g4KC","uuid":"2d25d4de-72f9-47dd-87b2-8fe68d8d1a35","name":"Date","displayName":null,"businessData":{"date":null},"elementData":{"isTimeShown":true,"showAsDuration":false},"blocked":false,"isPrimary":false,"isAutoCreated":false,"sortOrder":11,"visible":true,"created_at":"2016-10-10T15:15:57.306Z","updated_at":"2016-10-10T15:15:57.322Z","deprecated_at":null,"elementcategory":4,"listId":230,"description":null}];
 	let whenGetListView = new Promise(function(resolve, reject){
			resolve($.getJSON("../../listView.json"));
	}).then(function(listView) {
		//props.dispatch(hideLoading())
		return {
			listInfo: listView.list,
			listElements: listElements,
			listEntries: listView.listData
		}
	})
	return {
		type: "FETCH_LIST",
		payload: whenGetListView
	}
}
